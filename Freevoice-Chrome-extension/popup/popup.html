<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FreeVoice Reader</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <!-- Onboarding Overlay -->
  <div class="onboarding-overlay" id="onboarding" style="display: none;">
    <!-- Step 1: Welcome -->
    <div class="onboarding-content" id="onboarding-step-1">
      <svg class="onboarding-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="m3 11 18-5v12L3 14v-3z"/>
        <path d="M11.6 16.8a3 3 0 1 1-5.8-1.6"/>
        <path d="M21 15s-2.2 2-4.5 2"/>
      </svg>
      <h2 class="onboarding-title">Welcome to FreeVoice Reader</h2>
      <p class="onboarding-description">
        Convert any text on the web to natural speech. 50+ voices, 7 languages, 100% private - everything runs locally on your device.
      </p>
      <div class="onboarding-steps">
        <span class="onboarding-step active"></span>
        <span class="onboarding-step"></span>
        <span class="onboarding-step"></span>
      </div>
      <div class="onboarding-actions">
        <button class="btn btn-primary btn-block" id="onboarding-next-1">Get Started</button>
      </div>
    </div>

    <!-- Step 2: Download Model -->
    <div class="onboarding-content" id="onboarding-step-2" style="display: none;">
      <svg class="onboarding-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
        <polyline points="7,10 12,15 17,10"/>
        <line x1="12" y1="15" x2="12" y2="3"/>
      </svg>
      <h2 class="onboarding-title">Download AI Model</h2>
      <p class="onboarding-description">
        Download the TTS model (~80MB). This is a one-time download that enables offline text-to-speech.
      </p>
      <div class="progress-container" id="onboarding-progress" style="display: none; width: 100%;">
        <div class="progress-bar" id="onboarding-progress-bar"></div>
      </div>
      <p class="onboarding-description" id="onboarding-status"></p>
      <div class="onboarding-steps">
        <span class="onboarding-step"></span>
        <span class="onboarding-step active"></span>
        <span class="onboarding-step"></span>
      </div>
      <div class="onboarding-actions">
        <button class="btn btn-secondary" id="onboarding-back-2">Back</button>
        <button class="btn btn-primary" id="onboarding-download">Download Now</button>
      </div>
    </div>

    <!-- Step 3: Choose Voice & Speed -->
    <div class="onboarding-content" id="onboarding-step-3" style="display: none;">
      <h2 class="onboarding-title">Choose Your Defaults</h2>
      <p class="onboarding-description">
        Select a default voice and speed. You can change these anytime in Settings.
      </p>

      <div class="onboarding-section">
        <h3 class="onboarding-section-title">Voice</h3>
        <div class="voice-grid" id="voice-grid"></div>
      </div>

      <div class="onboarding-section">
        <h3 class="onboarding-section-title">Playback Speed</h3>
        <div class="speed-options" id="speed-options">
          <button class="speed-option" data-speed="0.75">0.75x</button>
          <button class="speed-option selected" data-speed="1">1.0x</button>
          <button class="speed-option" data-speed="1.25">1.25x</button>
          <button class="speed-option" data-speed="1.5">1.5x</button>
        </div>
      </div>

      <div class="onboarding-steps">
        <span class="onboarding-step"></span>
        <span class="onboarding-step"></span>
        <span class="onboarding-step active"></span>
      </div>
      <div class="onboarding-actions">
        <button class="btn btn-primary btn-block" id="onboarding-finish">Start Reading</button>
      </div>
    </div>
  </div>

  <!-- Main Popup -->
  <div class="popup-container" id="main-popup" style="display: flex;">
    <header class="popup-header">
      <div class="logo">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="logo-icon">
          <path d="m3 11 18-5v12L3 14v-3z"/>
          <path d="M11.6 16.8a3 3 0 1 1-5.8-1.6"/>
          <path d="M21 15s-2.2 2-4.5 2"/>
        </svg>
        <h1>FreeVoice Reader</h1>
      </div>
      <div class="status-badge" id="status-badge">
        <span class="status-dot"></span>
        <span class="status-text">Loading...</span>
      </div>
    </header>

    <main class="popup-main">
      <!-- Model Status Section -->
      <section class="section model-section" id="model-section">
        <div class="model-status" id="model-status">
          <div class="model-status-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/>
              <polyline points="7.5,4.21 12,6.81 16.5,4.21"/>
              <polyline points="7.5,19.79 7.5,14.6 3,12"/>
              <polyline points="21,12 16.5,14.6 16.5,19.79"/>
              <polyline points="3.27,6.96 12,12.01 20.73,6.96"/>
              <line x1="12" y1="22.08" x2="12" y2="12"/>
            </svg>
          </div>
          <div class="model-status-text">
            <span class="model-title">TTS Model</span>
            <span class="model-subtitle" id="model-subtitle">Not initialized</span>
          </div>
        </div>

        <div class="progress-container" id="progress-container" style="display: none;">
          <div class="progress-bar" id="progress-bar"></div>
        </div>
        <p class="model-hint" id="model-hint" style="display: none;">One-time download (~87MB). Model is saved locally for offline use.</p>

        <button class="btn btn-primary btn-block" id="init-btn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7,10 12,15 17,10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
          Download Voice Model (one-time)
        </button>
      </section>

      <!-- Quick Actions -->
      <section class="section">
        <h2 class="section-title">Quick Actions</h2>
        <div class="action-grid">
          <button class="action-btn" id="read-selection-btn" disabled>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
            </svg>
            <span>Read Selection</span>
          </button>
          <button class="action-btn" id="read-page-btn" disabled>
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
              <polyline points="14,2 14,8 20,8"/>
              <line x1="16" y1="13" x2="8" y2="13"/>
              <line x1="16" y1="17" x2="8" y2="17"/>
            </svg>
            <span>Read Page</span>
          </button>
        </div>
      </section>

      <!-- Text Input Section -->
      <section class="section">
        <h2 class="section-title">Or paste text here</h2>
        <textarea class="text-input" id="text-input" placeholder="Paste or type text to read aloud..." rows="4"></textarea>
        <button class="btn btn-secondary btn-block" id="read-text-btn" disabled>
          <svg viewBox="0 0 24 24" fill="currentColor">
            <polygon points="5,3 19,12 5,21"/>
          </svg>
          Read Text
        </button>
      </section>

      <!-- Voice Selection -->
      <section class="section">
        <h2 class="section-title">Voice</h2>
        <select class="select" id="voice-select">
          <optgroup label="American English - Female">
            <option value="af_heart">Heart ⭐</option>
            <option value="af_bella">Bella ⭐</option>
            <option value="af_nicole">Nicole</option>
            <option value="af_sarah">Sarah</option>
            <option value="af_nova">Nova</option>
            <option value="af_sky">Sky</option>
            <option value="af_alloy">Alloy</option>
            <option value="af_aoede">Aoede</option>
            <option value="af_jessica">Jessica</option>
            <option value="af_kore">Kore</option>
            <option value="af_river">River</option>
          </optgroup>
          <optgroup label="American English - Male">
            <option value="am_fenrir">Fenrir</option>
            <option value="am_michael">Michael</option>
            <option value="am_puck">Puck</option>
            <option value="am_adam">Adam</option>
            <option value="am_echo">Echo</option>
            <option value="am_eric">Eric</option>
            <option value="am_liam">Liam</option>
            <option value="am_onyx">Onyx</option>
            <option value="am_santa">Santa</option>
          </optgroup>
          <optgroup label="British English - Female">
            <option value="bf_emma">Emma ⭐</option>
            <option value="bf_isabella">Isabella</option>
            <option value="bf_alice">Alice</option>
            <option value="bf_lily">Lily</option>
          </optgroup>
          <optgroup label="British English - Male">
            <option value="bm_george">George</option>
            <option value="bm_lewis">Lewis</option>
            <option value="bm_daniel">Daniel</option>
            <option value="bm_fable">Fable</option>
          </optgroup>
          <optgroup label="Spanish">
            <option value="ef_dora">Dora (Female)</option>
            <option value="em_alex">Alex (Male)</option>
            <option value="em_santa">Santa (Male)</option>
          </optgroup>
          <optgroup label="French">
            <option value="ff_siwis">Siwis (Female) ⭐</option>
          </optgroup>
          <optgroup label="Hindi">
            <option value="hf_alpha">Alpha (Female)</option>
            <option value="hf_beta">Beta (Female)</option>
            <option value="hm_omega">Omega (Male)</option>
            <option value="hm_psi">Psi (Male)</option>
          </optgroup>
          <optgroup label="Italian">
            <option value="if_sara">Sara (Female)</option>
            <option value="im_nicola">Nicola (Male)</option>
          </optgroup>
          <optgroup label="Portuguese (Brazilian)">
            <option value="pf_dora">Dora (Female)</option>
            <option value="pm_alex">Alex (Male)</option>
            <option value="pm_santa">Santa (Male)</option>
          </optgroup>
        </select>
      </section>
    </main>

    <footer class="popup-footer">
      <div class="footer-top">
        <button class="btn-link" id="options-btn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"/>
            <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
          </svg>
          Settings
        </button>
        <div class="privacy-badge">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
          </svg>
          100% Private
        </div>
      </div>
      <a href="https://freevoicereader.com" target="_blank" class="website-link">freevoicereader.com</a>
    </footer>
  </div>

  <script src="popup.js"></script>
</body>
</html>
